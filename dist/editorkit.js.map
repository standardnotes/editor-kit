{"version":3,"sources":["webpack://EditorKit/webpack/universalModuleDefinition","webpack://EditorKit/./node_modules/@standardnotes/component-relay/dist/dist.js","webpack://EditorKit/external \"filesafe-js\"","webpack://EditorKit/webpack/bootstrap","webpack://EditorKit/webpack/runtime/create fake namespace object","webpack://EditorKit/webpack/runtime/define property getters","webpack://EditorKit/webpack/runtime/hasOwnProperty shorthand","webpack://EditorKit/webpack/runtime/make namespace object","webpack://EditorKit/./src/editorKit.ts","webpack://EditorKit/./src/index.ts"],"names":["EditorKitBase","constructor","delegate","options","connectToBridge","supportsFileSafe","fileSafeLoading","importFileSafe","coallesedSaving","coallesedSavingDelay","mode","componentRelay","ComponentRelay","targetWindow","window","onReady","platform","document","documentElement","classList","add","streamContextItem","note","isNewNoteLoad","uuid","itemClass","fileSafeClass","getSFItemClass","fileSafeInstance","setCurrentNote","isMetadataUpdate","text","content","isHtml","test","ignoreNextTextChange","previousText","needsFileSafeElementLoad","expandedFileSafeSyntax","setEditorRawText","clearUndoHistory","then","result","default","configureFileSafe","componentManager","addDataChangeObserver","allFileDescriptors","getAllFileDescriptors","fileIdsPendingAssociation","length","hasMatch","slice","descriptor","find","candidate","splice","indexOf","syntax","insertionSyntaxForFileDescriptor","insertRawText","textExpander","searchPatterns","fileLoader","loadFileSafeElements","addNewFileDescriptorHandler","fileDescriptor","push","FileLoader","getElementsBySelector","insertElement","preprocessElement","TextExpander","afterExpand","getCurrentLineText","getPreviousLineText","replaceText","patterns","regex","FileSafeSyntaxPattern","callback","matchedText","getFileSafe","onEditorKeyUp","isSpace","isEnter","onKeyUp","onEditorPaste","isPaste","onEditorValueChanged","collapseFileSafeSyntax","sameText","saveItemWithPresave","generateCustomPreview","html","preview_html","plain","preview_plain","preview","removeFileSafeSyntaxFromHtml","truncateString","htmlToText","canUploadFiles","credentials","getAllCredentials","integrations","getAllIntegrations","uploadJSFileObject","file","cursorIdentifier","insertStatusAtCursor","encryptAndUploadJavaScriptFileObject","removeCursorStatus"],"mappings":"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","file":"editorkit.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"filesafe-js\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"EditorKit\", [\"filesafe-js\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"EditorKit\"] = factory(require(\"filesafe-js\"));\n\telse\n\t\troot[\"EditorKit\"] = factory(root[\"filesafe-js\"]);\n})(self, function(__WEBPACK_EXTERNAL_MODULE__695__) {\nreturn ","!function(e,t){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define(\"ComponentRelay\",[],t):\"object\"==typeof exports?exports.ComponentRelay=t():e.ComponentRelay=t()}(self,(function(){return(()=>{\"use strict\";var e={d:(t,s)=>{for(var n in s)e.o(s,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:s[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};let s,n,i;var o;e.d(t,{default:()=>C}),function(e){e.SetSize=\"set-size\",e.StreamItems=\"stream-items\",e.StreamContextItem=\"stream-context-item\",e.SaveItems=\"save-items\",e.SelectItem=\"select-item\",e.AssociateItem=\"associate-item\",e.DeassociateItem=\"deassociate-item\",e.ClearSelection=\"clear-selection\",e.CreateItem=\"create-item\",e.CreateItems=\"create-items\",e.DeleteItems=\"delete-items\",e.SetComponentData=\"set-component-data\",e.InstallLocalComponent=\"install-local-component\",e.ToggleActivateComponent=\"toggle-activate-component\",e.RequestPermissions=\"request-permissions\",e.PresentConflictResolution=\"present-conflict-resolution\",e.DuplicateItem=\"duplicate-item\",e.ComponentRegistered=\"component-registered\",e.ActivateThemes=\"themes\",e.Reply=\"reply\",e.SaveSuccess=\"save-success\",e.SaveError=\"save-error\",e.ThemesActivated=\"themes-activated\"}(s||(s={})),function(e){e[e.Web=1]=\"Web\",e[e.Desktop=2]=\"Desktop\",e[e.Mobile=3]=\"Mobile\"}(n||(n={})),function(e){e.Any=\"*\",e.Item=\"SF|Item\",e.RootKey=\"SN|RootKey|NoSync\",e.ItemsKey=\"SN|ItemsKey\",e.EncryptedStorage=\"SN|EncryptedStorage\",e.Note=\"Note\",e.Tag=\"Tag\",e.SmartTag=\"SN|SmartTag\",e.Component=\"SN|Component\",e.Editor=\"SN|Editor\",e.ActionsExtension=\"Extension\",e.UserPrefs=\"SN|UserPreferences\",e.Privileges=\"SN|Privileges\",e.HistorySession=\"SN|HistorySession\",e.Theme=\"SN|Theme\",e.Mfa=\"SF|MFA\",e.ServerExtension=\"SF|Extension\",e.FilesafeCredentials=\"SN|FileSafe|Credentials\",e.FilesafeFileMetadata=\"SN|FileSafe|FileMetadata\",e.FilesafeIntegration=\"SN|FileSafe|Integration\",e.ExtensionRepo=\"SN|ExtensionRepo\"}(i||(i={}));var a=new Uint8Array(16);function r(){if(!o&&!(o=\"undefined\"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||\"undefined\"!=typeof msCrypto&&\"function\"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error(\"crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported\");return o(a)}const m=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,c=function(e){return\"string\"==typeof e&&m.test(e)};for(var l=[],d=0;d<256;++d)l.push((d+256).toString(16).substr(1));const p=function(e,t,s){var n=(e=e||{}).random||(e.rng||r)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){s=s||0;for(var i=0;i<16;++i)t[s+i]=n[i];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=(l[e[t+0]]+l[e[t+1]]+l[e[t+2]]+l[e[t+3]]+\"-\"+l[e[t+4]]+l[e[t+5]]+\"-\"+l[e[t+6]]+l[e[t+7]]+\"-\"+l[e[t+8]]+l[e[t+9]]+\"-\"+l[e[t+10]]+l[e[t+11]]+l[e[t+12]]+l[e[t+13]]+l[e[t+14]]+l[e[t+15]]).toLowerCase();if(!c(s))throw TypeError(\"Stringified UUID is invalid\");return s}(n)},h=e=>{var t;const s={[n.Web]:\"web\",[n.Desktop]:\"desktop\",[n.Mobile]:\"mobile\"};return null!==(t=s[e])&&void 0!==t?t:s[n.Web]},g=()=>{};class u{static get isSupported(){return!(!window.console&&!console)}static get info(){return u.isSupported&&this.enabled?console.log.bind(console):g}static get error(){return u.isSupported?console.error.bind(console):g}}var v,f,S;function y(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function b(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?y(Object(s),!0).forEach((function(t){I(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):y(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function I(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}(f=\"enabled\")in(v=u)?Object.defineProperty(v,f,{value:false,enumerable:!0,configurable:!0,writable:!0}):v[f]=false,function(e){e.Component=\"component\"}(S||(S={}));class C{constructor(e){if(I(this,\"contentWindow\",void 0),I(this,\"initialPermissions\",void 0),I(this,\"onReadyCallback\",void 0),I(this,\"component\",{activeThemes:[],acceptsThemes:!0}),I(this,\"sentMessages\",[]),I(this,\"messageQueue\",[]),I(this,\"lastStreamedItem\",void 0),I(this,\"pendingSaveItems\",void 0),I(this,\"pendingSaveTimeout\",void 0),I(this,\"pendingSaveParams\",void 0),I(this,\"coallesedSaving\",!1),I(this,\"coallesedSavingDelay\",250),I(this,\"messageHandler\",void 0),!e||!e.targetWindow)throw new Error(\"contentWindow must be a valid Window object.\");this.contentWindow=e.targetWindow,this.processParameters(e),this.registerMessageHandler()}processParameters(e){var t;const{initialPermissions:s,options:n,onReady:i}=e;var o;s&&s.length>0&&(this.initialPermissions=s),null!=n&&n.coallesedSaving&&(this.coallesedSaving=n.coallesedSaving),null!=n&&n.coallesedSavingDelay&&(this.coallesedSavingDelay=n.coallesedSavingDelay),null!=n&&n.acceptsThemes&&(this.component.acceptsThemes=null===(o=null==n?void 0:n.acceptsThemes)||void 0===o||o),i&&(this.onReadyCallback=i),u.enabled=null!==(t=null==n?void 0:n.debug)&&void 0!==t&&t}deinit(){this.onReadyCallback=void 0,this.component={acceptsThemes:!0,activeThemes:[]},this.messageQueue=[],this.sentMessages=[],this.lastStreamedItem=void 0,this.pendingSaveItems=void 0,this.pendingSaveTimeout=void 0,this.pendingSaveParams=void 0,this.messageHandler&&(this.contentWindow.document.removeEventListener(\"message\",this.messageHandler),this.contentWindow.removeEventListener(\"message\",this.messageHandler))}registerMessageHandler(){this.messageHandler=e=>{if(u.info(\"Components API Message received:\",e.data),document.referrer&&new URL(document.referrer).origin!==new URL(e.origin).origin)return;if(this.component.origin){if(e.origin!==this.component.origin)return}else this.component.origin=e.origin;const{data:t}=e,s=(e=>{if(\"string\"!=typeof e)return!1;try{const t=JSON.parse(e),s=Object.prototype.toString.call(t);return\"[object Object]\"===s||\"[object Array]\"===s}catch(e){return!1}})(t)?JSON.parse(t):t;s?this.handleMessage(s):u.error(\"Invalid data received. Skipping...\")},this.contentWindow.document.addEventListener(\"message\",this.messageHandler,!1),this.contentWindow.addEventListener(\"message\",this.messageHandler,!1),u.info(\"Waiting for messages...\")}handleMessage(e){switch(e.action){case s.ComponentRegistered:this.component.sessionKey=e.sessionKey,e.componentData&&(this.component.data=e.componentData),this.onReady(e.data),u.info(\"Component successfully registered with payload:\",e);break;case s.ActivateThemes:this.activateThemes(e.data.themes);break;default:{var t,n;if(!e.original)return;const s=null===(t=this.sentMessages)||void 0===t?void 0:t.filter((t=>{var s;return t.messageId===(null===(s=e.original)||void 0===s?void 0:s.messageId)}))[0];if(!s){const e=this.contentWindow.document.title,t=(\"The extension '\".concat(e,\"' is attempting to communicate with Standard Notes, \")+\"but an error is preventing it from doing so. Please restart this extension and try again.\").replace(\"  \",\" \");return void u.info(t)}null==s||null===(n=s.callback)||void 0===n||n.call(s,e.data);break}}}onReady(e){this.component.environment=e.environment,this.component.platform=e.platform,this.component.uuid=e.uuid,this.initialPermissions&&this.initialPermissions.length>0&&this.requestPermissions(this.initialPermissions);for(const e of this.messageQueue)this.postMessage(e.action,e.data,e.callback);this.messageQueue=[],u.info(\"Data passed to onReady:\",e),this.activateThemes(e.activeThemeUrls||[]),this.postMessage(s.ThemesActivated,{}),this.onReadyCallback&&this.onReadyCallback()}getSelfComponentUUID(){return this.component.uuid}isRunningInDesktopApplication(){return this.component.environment===h(n.Desktop)}isRunningInMobileApplication(){return this.component.environment===h(n.Mobile)}getComponentDataValueForKey(e){if(this.component.data)return this.component.data[e]}setComponentDataValueForKey(e,t){if(!this.component.data)throw new Error(\"The component has not been initialized.\");if(!e||e&&0===e.length)throw new Error(\"The key for the data value should be a valid string.\");this.component.data=b(b({},this.component.data),{},{[e]:t}),this.postMessage(s.SetComponentData,{componentData:this.component.data})}clearComponentData(){this.component.data={},this.postMessage(s.SetComponentData,{componentData:this.component.data})}postMessage(e,t,s){if(!this.component.sessionKey)return void this.messageQueue.push({action:e,data:t,api:S.Component,callback:s});const n={action:e,data:t,messageId:this.generateUUID(),sessionKey:this.component.sessionKey,api:S.Component},i=JSON.parse(JSON.stringify(n));let o;i.callback=s,this.sentMessages.push(i),o=this.isRunningInMobileApplication()?JSON.stringify(n):n,u.info(\"Posting message:\",o),this.contentWindow.parent.postMessage(o,this.component.origin)}requestPermissions(e,t){this.postMessage(s.RequestPermissions,{permissions:e},(()=>{t&&t()}))}activateThemes(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!this.component.acceptsThemes)return;u.info(\"Incoming themes:\",e);const{activeThemes:t}=this.component;if(t&&t.sort().toString()==e.sort().toString())return;let s=e;const n=[];for(const i of t)e.includes(i)?s=s.filter((e=>e!==i)):n.push(i);u.info(\"Deactivating themes:\",n),u.info(\"Activating themes:\",s);for(const e of n)this.deactivateTheme(e);this.component.activeThemes=e;for(const e of s){if(!e)continue;const t=this.contentWindow.document.createElement(\"link\");t.id=btoa(e),t.href=e,t.type=\"text/css\",t.rel=\"stylesheet\",t.media=\"screen,print\",t.className=\"custom-theme\",this.contentWindow.document.getElementsByTagName(\"head\")[0].appendChild(t)}}themeElementForUrl(e){return Array.from(this.contentWindow.document.getElementsByClassName(\"custom-theme\")).slice().find((t=>t.id==btoa(e)))}deactivateTheme(e){const t=this.themeElementForUrl(e);t&&t.parentNode&&(t.setAttribute(\"disabled\",\"true\"),t.parentNode.removeChild(t))}generateUUID(){return p()}get platform(){return this.component.platform}get environment(){return this.component.environment}streamItems(e,t){this.postMessage(s.StreamItems,{content_types:e},(e=>{t(e.items)}))}streamContextItem(e){this.postMessage(s.StreamContextItem,{},(t=>{const{item:s}=t;(!this.lastStreamedItem||this.lastStreamedItem.uuid!==s.uuid)&&this.pendingSaveTimeout&&(clearTimeout(this.pendingSaveTimeout),this._performSavingOfItems(this.pendingSaveParams),this.pendingSaveTimeout=void 0,this.pendingSaveParams=void 0),this.lastStreamedItem=s,e(this.lastStreamedItem)}))}selectItem(e){this.postMessage(s.SelectItem,{item:this.jsonObjectForItem(e)})}clearSelection(){this.postMessage(s.ClearSelection,{content_type:i.Tag})}createItem(e,t){this.postMessage(s.CreateItem,{item:this.jsonObjectForItem(e)},(e=>{let{item:s}=e;!s&&e.items&&e.items.length>0&&(s=e.items[0]),this.associateItem(s),t&&t(s)}))}createItems(e,t){const n=e.map((e=>this.jsonObjectForItem(e)));this.postMessage(s.CreateItems,{items:n},(e=>{t&&t(e.items)}))}associateItem(e){this.postMessage(s.AssociateItem,{item:this.jsonObjectForItem(e)})}deassociateItem(e){this.postMessage(s.DeassociateItem,{item:this.jsonObjectForItem(e)})}deleteItem(e,t){this.deleteItems([e],t)}deleteItems(e,t){const n={items:e.map((e=>this.jsonObjectForItem(e)))};this.postMessage(s.DeleteItems,n,(e=>{t&&t(e)}))}sendCustomEvent(e,t,s){this.postMessage(e,t,(e=>{s&&s(e)}))}saveItem(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.saveItems([e],t,s)}saveItemWithPresave(e,t,s){this.saveItemsWithPresave([e],t,s)}saveItemsWithPresave(e,t,s){this.saveItems(e,s,!1,t)}_performSavingOfItems(e){let{items:t,presave:n,callback:i}=e;n&&n();const o=[];for(const e of t)o.push(this.jsonObjectForItem(e));this.postMessage(s.SaveItems,{items:o},(()=>{i&&i()}))}saveItems(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3?arguments[3]:void 0;if(this.pendingSaveItems||(this.pendingSaveItems=[]),this.coallesedSaving&&!s){this.pendingSaveTimeout&&clearTimeout(this.pendingSaveTimeout);const s=e.map((e=>e.uuid)),i=this.pendingSaveItems.filter((e=>!s.includes(e.uuid)));this.pendingSaveItems=i.concat(e),this.pendingSaveParams={items:this.pendingSaveItems,presave:n,callback:t},this.pendingSaveTimeout=setTimeout((()=>{this._performSavingOfItems(this.pendingSaveParams),this.pendingSaveItems=[],this.pendingSaveTimeout=void 0,this.pendingSaveParams=null}),this.coallesedSavingDelay)}else this._performSavingOfItems({items:e,presave:n,callback:t})}setSize(e,t){this.postMessage(s.SetSize,{type:\"container\",width:e,height:t})}jsonObjectForItem(e){const t=Object.assign({},e);return t.children=null,t.parent=null,t}getItemAppDataValue(e,t){return e.getAppDomainValue(t)}}return t.default})()}));\n//# sourceMappingURL=dist.js.map","module.exports = __WEBPACK_EXTERNAL_MODULE__695__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","var getProto = Object.getPrototypeOf ? (obj) => (Object.getPrototypeOf(obj)) : (obj) => (obj.__proto__);\nvar leafPrototypes;\n// create a fake namespace object\n// mode & 1: value is a module id, require it\n// mode & 2: merge all properties of value into the ns\n// mode & 4: return value when already ns object\n// mode & 16: return value when it's Promise-like\n// mode & 8|1: behave like require\n__webpack_require__.t = function(value, mode) {\n\tif(mode & 1) value = this(value);\n\tif(mode & 8) return value;\n\tif(typeof value === 'object' && value) {\n\t\tif((mode & 4) && value.__esModule) return value;\n\t\tif((mode & 16) && typeof value.then === 'function') return value;\n\t}\n\tvar ns = Object.create(null);\n\t__webpack_require__.r(ns);\n\tvar def = {};\n\tleafPrototypes = leafPrototypes || [null, getProto({}), getProto([]), getProto(getProto)];\n\tfor(var current = mode & 2 && value; typeof current == 'object' && !~leafPrototypes.indexOf(current); current = getProto(current)) {\n\t\tObject.getOwnPropertyNames(current).forEach((key) => (def[key] = () => (value[key])));\n\t}\n\tdef['default'] = () => (value);\n\t__webpack_require__.d(ns, def);\n\treturn ns;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import ComponentRelay from '@standardnotes/component-relay'\nimport FileLoader from './fileLoader'\nimport TextExpander from './textExpander'\nimport {\n  truncateString,\n  htmlToText\n} from './utils'\nimport {\n  FileSafeSyntaxPattern,\n  collapseFileSafeSyntax,\n  expandedFileSafeSyntax,\n  insertionSyntaxForFileDescriptor,\n  removeFileSafeSyntaxFromHtml,\n  FileSafeFileMetadata\n} from './fileSafeHtml'\n\ntype GenericCallback = (...params: any[]) => any\n\ninterface EditorKitDelegate {\n  insertRawText: GenericCallback\n  onReceiveNote: GenericCallback\n  setEditorRawText: GenericCallback\n  getCurrentLineText: GenericCallback\n  getPreviousLineText: GenericCallback\n  replaceText: GenericCallback\n  getElementsBySelector: GenericCallback\n  insertElement: GenericCallback\n  preprocessElement: GenericCallback\n  clearUndoHistory: GenericCallback\n  generateCustomPreview: GenericCallback\n}\n\ntype EditorKitOptions = {\n  mode: 'plaintext' | 'html' | 'markdown'\n  supportsFileSafe: false\n  coallesedSaving: false\n  coallesedSavingDelay: 250\n}\n\ntype FileUuid = string\n\nexport default class EditorKitBase {\n  private fileIdsPendingAssociation: FileUuid[] = []\n  private componentRelay?: ComponentRelay\n  private fileLoader?: FileLoader\n  private textExpander?: TextExpander\n\n  private fileSafeLoading?: Promise<void>\n  private fileSafeClass?: any\n  private fileSafeInstance?: any\n\n  private note: any\n  private ignoreNextTextChange?: boolean\n  private needsFileSafeElementLoad?: boolean\n  private previousText?: string\n\n  constructor(private delegate: EditorKitDelegate, private options: EditorKitOptions) {\n    this.connectToBridge()\n\n    if (this.options.supportsFileSafe) {\n      this.fileSafeLoading = this.importFileSafe()\n    }\n  }\n\n  private connectToBridge() {\n    const {\n      coallesedSaving,\n      coallesedSavingDelay,\n      mode,\n      supportsFileSafe\n    } = this.options\n\n    this.componentRelay = new ComponentRelay({\n      targetWindow: window,\n      options: {\n        coallesedSaving,\n        /**\n         * The editor does some debouncing for us, so we'll lower the\n         * default debounce value from 250 to 150\n         */\n        coallesedSavingDelay\n      },\n      onReady: () => {\n        const { platform } = this.componentRelay!\n\n        if (platform) {\n          document.documentElement.classList.add(platform)\n        }\n      }\n    })\n\n    this.componentRelay.streamContextItem((note) => {\n      /**\n       * TODO: If note has changed, release previous temp object URLs.\n       */\n      let isNewNoteLoad = true\n      if (this.note && this.note.uuid == note.uuid) {\n        isNewNoteLoad = false\n      }\n\n      if (supportsFileSafe) {\n        const itemClass = this.fileSafeClass.getSFItemClass()\n        this.note = new itemClass(note)\n        this.fileSafeInstance.setCurrentNote(this.note)\n      } else {\n        this.note = note\n      }\n\n       // Only update UI on non-metadata updates.\n      if (note.isMetadataUpdate) return\n\n      let text = note.content.text\n\n      /**\n       * If we're an HTML editor, and we're dealing with a new note,\n       * check to see if it's in html format.\n       * If it's not, we don't want to convert it to HTML until the user makes an explicit change\n       * so we'll ignore the next change event in this case.\n       */\n      if (mode === 'html' && isNewNoteLoad) {\n        const isHtml = /<[a-z][\\s\\S]*>/i.test(text)\n        if (!isHtml) {\n          this.ignoreNextTextChange = true\n        }\n      }\n\n      /**\n       * Set before expanding. \n       * We want this value to always be the collapsed value\n       */\n      this.previousText = text\n\n      if (supportsFileSafe) {\n        /**\n         * We want to expand any filesafe syntax in the text,\n         * but only after the text has been inserted.\n         * (Will be checked on editor change callback)\n         */\n        this.needsFileSafeElementLoad = true\n        text = expandedFileSafeSyntax(text)\n      }\n\n      this.delegate.setEditorRawText(text)\n\n      if (isNewNoteLoad) {\n        this.delegate.clearUndoHistory()\n      }\n    })\n  }\n\n  private async importFileSafe() {\n    if (!this.options.supportsFileSafe) {\n      return\n    }\n    return import('filesafe-js').then((result) => {\n      this.fileSafeClass = result.default\n      this.configureFileSafe()\n      return this.fileSafeInstance\n    })\n  }\n\n  private configureFileSafe() {\n    this.fileSafeInstance = new this.fileSafeClass({\n      componentManager: this.componentRelay\n    })\n\n    this.fileSafeInstance.addDataChangeObserver(() => {\n      // Reload UI by querying FileSafe for changes...\n      const allFileDescriptors = this.fileSafeInstance.getAllFileDescriptors()\n\n      if (this.note && this.fileIdsPendingAssociation.length > 0) {\n        let hasMatch = false\n\n        for (const uuid of this.fileIdsPendingAssociation.slice()) {\n          const descriptor = allFileDescriptors.find((candidate: FileSafeFileMetadata) => candidate.uuid == uuid)\n\n          if (!descriptor) {\n            continue\n          }\n\n          hasMatch = true\n          this.fileIdsPendingAssociation.splice(this.fileIdsPendingAssociation.indexOf(uuid), 1)\n\n          const syntax = insertionSyntaxForFileDescriptor(descriptor)\n          this.delegate.insertRawText(syntax)\n        }\n\n        if (hasMatch) {\n          this.textExpander!.searchPatterns()\n        }\n      }\n\n      if (allFileDescriptors.length > 0) {\n        this.fileLoader!.loadFileSafeElements()\n      }\n    })\n\n    this.fileSafeInstance.addNewFileDescriptorHandler((fileDescriptor: FileSafeFileMetadata) => {\n      /**\n       * Called when a new file is uploaded. We'll wait until the bridge acknowledges\n       * receipt of this item, and then it will be added to the editor.\n       */\n      this.fileIdsPendingAssociation.push(fileDescriptor.uuid)\n    })\n\n    this.fileLoader = new FileLoader({\n      fileSafeInstance: this.fileSafeInstance,\n      getElementsBySelector: this.delegate.getElementsBySelector,\n      insertElement: this.delegate.insertElement,\n      preprocessElement: this.delegate.preprocessElement\n    })\n\n    this.textExpander = new TextExpander({\n      afterExpand: () => {\n        this.fileLoader!.loadFileSafeElements()\n      },\n      getCurrentLineText: this.delegate.getCurrentLineText,\n      getPreviousLineText: this.delegate.getPreviousLineText,\n      replaceText: this.delegate.replaceText,\n      patterns: [{\n        regex: FileSafeSyntaxPattern,\n        callback: (matchedText) => {\n          return expandedFileSafeSyntax(matchedText)\n        }\n      }]\n    })\n  }\n\n  public async getFileSafe(): Promise<void> {\n    if (!this.fileSafeInstance && this.fileSafeLoading) {\n      return this.fileSafeLoading\n    }\n    return this.importFileSafe()\n  }\n\n  public onEditorKeyUp({ isSpace, isEnter }: { isSpace: boolean, isEnter: boolean }): void {\n    this.textExpander!.onKeyUp({\n       isSpace,\n       isEnter\n    })\n  }\n\n  public onEditorPaste(): void {\n    this.textExpander!.onKeyUp({\n      isPaste: true\n    })\n  }\n\n  public onEditorValueChanged(text: string): void {\n    const { mode, supportsFileSafe } = this.options\n\n    if (this.needsFileSafeElementLoad) {\n      this.needsFileSafeElementLoad = false\n      this.fileLoader!.loadFileSafeElements()\n    }\n\n    if (this.ignoreNextTextChange) {\n      this.ignoreNextTextChange = false\n      return\n    }\n\n    if (supportsFileSafe) {\n      text = collapseFileSafeSyntax(text)\n\n      /**\n       * Change events may be triggered several times when expanding filesafe syntax.\n       * Ultimately, while the visual layer is changing a lot, the underlying text layer,\n       * after being collapsed, will not change. So we'll compare the previous html to new collapsed html before continuing.\n       */\n      const sameText = this.previousText == text\n      if (sameText) return\n    }\n\n    this.previousText = text\n\n    const note = this.note\n\n    if (!note) return\n\n    this.componentRelay!.saveItemWithPresave(note, null, () => {\n      note.content.text = text\n\n      if (this.delegate.generateCustomPreview) {\n        const result = this.delegate.generateCustomPreview(text)\n\n        if (result.html) {\n          note.content.preview_html = result.html\n        } else if (result.plain) {\n          note.content.preview_plain = result.plain\n        }\n      } else {\n        if (mode == 'html') {\n          let preview = removeFileSafeSyntaxFromHtml(text)\n          preview = truncateString(htmlToText(preview))\n          /**\n           * If the preview has no length due to either being an empty note, or having just 1 FileSafe file\n           * that is stripped above, then we don't want to set to empty string, otherwise SN app will default to content\n           * for preview. We'll set a whitespace preview instead so SN doesn't go based on innate content.\n           */\n          note.content.preview_plain = preview.length > 0 ? preview : ' '\n        } else {\n          note.content.preview_plain = text\n        }\n\n        // We're only using plain in this block.\n        note.content.preview_html = null\n      }\n    })\n  }\n\n  public canUploadFiles(): boolean {\n    const credentials = this.fileSafeInstance.getAllCredentials()\n    const integrations = this.fileSafeInstance.getAllIntegrations()\n    return credentials.length > 0 && integrations.length > 0\n  }\n\n  async uploadJSFileObject(file: string): Promise<void> {\n    const cursorIdentifier = this.fileLoader!.insertStatusAtCursor('Processing file...')\n    return this.fileSafeInstance.encryptAndUploadJavaScriptFileObject(file).then(() => {\n      this.fileLoader!.removeCursorStatus(cursorIdentifier)\n    })\n  }\n}\n","import EditorKit from './editorKit'\n\nexport {\n  EditorKit\n}"],"sourceRoot":""}