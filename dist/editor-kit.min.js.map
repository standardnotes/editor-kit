{"version":3,"file":"editor-kit.min.js","mappings":"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","sources":["webpack://EditorKit/webpack/universalModuleDefinition","webpack://EditorKit/./node_modules/@standardnotes/component-relay/dist/dist.js","webpack://EditorKit/webpack/bootstrap","webpack://EditorKit/webpack/runtime/compat get default export","webpack://EditorKit/webpack/runtime/define property getters","webpack://EditorKit/webpack/runtime/hasOwnProperty shorthand","webpack://EditorKit/./src/EditorKit.ts","webpack://EditorKit/./src/Utils.ts"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"EditorKit\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"EditorKit\"] = factory();\n\telse\n\t\troot[\"EditorKit\"] = factory();\n})(self, () => {\nreturn ","!function(e,t){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define(\"ComponentRelay\",[],t):\"object\"==typeof exports?exports.ComponentRelay=t():e.ComponentRelay=t()}(self,(()=>(()=>{\"use strict\";var e={d:(t,n)=>{for(var s in n)e.o(n,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:n[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};let n;var s;e.d(t,{default:()=>w}),function(e){e[e.Web=1]=\"Web\",e[e.Desktop=2]=\"Desktop\",e[e.Mobile=3]=\"Mobile\"}(n||(n={}));var i=new Uint8Array(16);function o(){if(!s&&!(s=\"undefined\"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||\"undefined\"!=typeof msCrypto&&\"function\"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error(\"crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported\");return s(i)}const a=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,r=function(e){return\"string\"==typeof e&&a.test(e)};for(var m=[],c=0;c<256;++c)m.push((c+256).toString(16).substr(1));const h=function(e,t,n){var s=(e=e||{}).random||(e.rng||o)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t){n=n||0;for(var i=0;i<16;++i)t[n+i]=s[i];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(m[e[t+0]]+m[e[t+1]]+m[e[t+2]]+m[e[t+3]]+\"-\"+m[e[t+4]]+m[e[t+5]]+\"-\"+m[e[t+6]]+m[e[t+7]]+\"-\"+m[e[t+8]]+m[e[t+9]]+\"-\"+m[e[t+10]]+m[e[t+11]]+m[e[t+12]]+m[e[t+13]]+m[e[t+14]]+m[e[t+15]]).toLowerCase();if(!r(n))throw TypeError(\"Stringified UUID is invalid\");return n}(s)},d=e=>{var t;const s={[n.Web]:\"web\",[n.Desktop]:\"desktop\",[n.Mobile]:\"mobile\"};return null!==(t=s[e])&&void 0!==t?t:s[n.Web]},p=()=>{};class l{static get isSupported(){return!(!window.console&&!console)}static get info(){return l.isSupported&&this.enabled?console.log.bind(console):p}static get error(){return l.isSupported?console.error.bind(console):p}}var u,v;let g,f,y;function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){k(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function k(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(v=\"enabled\")in(u=l)?Object.defineProperty(u,v,{value:false,enumerable:!0,configurable:!0,writable:!0}):u[v]=false,function(e){e.Shift=\"Shift\",e.Ctrl=\"Control\",e.Meta=\"Meta\"}(g||(g={})),function(e){e.Component=\"component\"}(f||(f={})),function(e){e.SetSize=\"set-size\",e.StreamItems=\"stream-items\",e.StreamContextItem=\"stream-context-item\",e.SaveItems=\"save-items\",e.CreateItem=\"create-item\",e.CreateItems=\"create-items\",e.DeleteItems=\"delete-items\",e.SetComponentData=\"set-component-data\",e.RequestPermissions=\"request-permissions\",e.DuplicateItem=\"duplicate-item\",e.ComponentRegistered=\"component-registered\",e.ActivateThemes=\"themes\",e.Reply=\"reply\",e.ThemesActivated=\"themes-activated\",e.KeyDown=\"key-down\",e.KeyUp=\"key-up\",e.Click=\"click\"}(y||(y={}));class w{constructor(e){var t,n;if(k(this,\"contentWindow\",void 0),k(this,\"component\",{activeThemes:[],acceptsThemes:!0}),k(this,\"sentMessages\",[]),k(this,\"messageQueue\",[]),k(this,\"lastStreamedItem\",void 0),k(this,\"pendingSaveItems\",void 0),k(this,\"pendingSaveTimeout\",void 0),k(this,\"pendingSaveParams\",void 0),k(this,\"messageHandler\",void 0),k(this,\"keyDownEventListener\",void 0),k(this,\"keyUpEventListener\",void 0),k(this,\"clickEventListener\",void 0),k(this,\"concernTimeouts\",[]),k(this,\"options\",void 0),k(this,\"params\",void 0),!e||!e.targetWindow)throw new Error(\"contentWindow must be a valid Window object.\");this.params=e,this.options=e.options||{},null==this.options.coallesedSaving&&(this.options.coallesedSaving=!0),null==this.options.coallesedSavingDelay&&(this.options.coallesedSavingDelay=250),null!=this.options.acceptsThemes&&(this.component.acceptsThemes=null===(n=this.options.acceptsThemes)||void 0===n||n),l.enabled=null!==(t=this.options.debug)&&void 0!==t&&t,this.contentWindow=e.targetWindow,this.registerMessageHandler(),this.registerKeyboardEventListeners(),this.registerMouseEventListeners()}deinit(){this.params.onReady=void 0,this.component={acceptsThemes:!0,activeThemes:[]},this.messageQueue=[],this.sentMessages=[],this.lastStreamedItem=void 0,this.pendingSaveItems=void 0,this.pendingSaveTimeout=void 0,this.pendingSaveParams=void 0,this.messageHandler&&(this.contentWindow.document.removeEventListener(\"message\",this.messageHandler),this.contentWindow.removeEventListener(\"message\",this.messageHandler)),this.keyDownEventListener&&this.contentWindow.removeEventListener(\"keydown\",this.keyDownEventListener),this.keyUpEventListener&&this.contentWindow.removeEventListener(\"keyup\",this.keyUpEventListener),this.clickEventListener&&this.contentWindow.removeEventListener(\"click\",this.clickEventListener)}registerMessageHandler(){this.messageHandler=e=>{if(l.info(\"Components API Message received:\",e.data),document.referrer&&new URL(document.referrer).origin!==new URL(e.origin).origin)return;const{data:t}=e,n=(e=>{if(\"string\"!=typeof e)return!1;try{const t=JSON.parse(e),n=Object.prototype.toString.call(t);return\"[object Object]\"===n||\"[object Array]\"===n}catch(e){return!1}})(t)?JSON.parse(t):t;if(n){if(void 0===this.component.origin&&n.action===y.ComponentRegistered)this.component.origin=e.origin;else if(e.origin!==this.component.origin)return;this.handleMessage(n)}else l.error(\"Invalid data received. Skipping...\")},this.contentWindow.document.addEventListener(\"message\",this.messageHandler,!1),this.contentWindow.addEventListener(\"message\",this.messageHandler,!1),l.info(\"Waiting for messages...\")}registerKeyboardEventListeners(){this.keyDownEventListener=e=>{l.info(\"A key has been pressed: \".concat(e.key)),e.ctrlKey?this.keyDownEvent(g.Ctrl):e.shiftKey?this.keyDownEvent(g.Shift):(e.metaKey||\"Meta\"===e.key)&&this.keyDownEvent(g.Meta)},this.keyUpEventListener=e=>{l.info(\"A key has been released: \".concat(e.key)),\"Control\"===e.key?this.keyUpEvent(g.Ctrl):\"Shift\"===e.key?this.keyUpEvent(g.Shift):\"Meta\"===e.key&&this.keyUpEvent(g.Meta)},this.contentWindow.addEventListener(\"keydown\",this.keyDownEventListener,!1),this.contentWindow.addEventListener(\"keyup\",this.keyUpEventListener,!1)}registerMouseEventListeners(){this.clickEventListener=e=>{l.info(\"A click has been performed.\"),this.mouseClickEvent()},this.contentWindow.addEventListener(\"click\",this.clickEventListener,!1)}handleMessage(e){switch(e.action){case y.ComponentRegistered:this.component.sessionKey=e.sessionKey,e.componentData&&(this.component.data=e.componentData),this.onReady(e.data),l.info(\"Component successfully registered with payload:\",e);break;case y.ActivateThemes:this.activateThemes(e.data.themes);break;default:{var t,n;if(!e.original)return;const s=null===(t=this.sentMessages)||void 0===t?void 0:t.filter((t=>{var n;return t.messageId===(null===(n=e.original)||void 0===n?void 0:n.messageId)}))[0];if(!s){const e=this.contentWindow.document.title,t=(\"The extension '\".concat(e,\"' is attempting to communicate with Standard Notes, \")+\"but an error is preventing it from doing so. Please restart this extension and try again.\").replace(\"  \",\" \");return void l.info(t)}null==s||null===(n=s.callback)||void 0===n||n.call(s,e.data);break}}}onReady(e){this.component.environment=e.environment,this.component.platform=e.platform,this.component.uuid=e.uuid;for(const e of this.messageQueue)this.postMessage(e.action,e.data,e.callback);this.messageQueue=[],l.info(\"Data passed to onReady:\",e),this.activateThemes(e.activeThemeUrls||[]),this.postMessage(y.ThemesActivated,{}),this.params.onReady&&this.params.onReady()}getSelfComponentUUID(){return this.component.uuid}isRunningInDesktopApplication(){return this.component.environment===d(n.Desktop)}isRunningInMobileApplication(){return this.component.environment===d(n.Mobile)}getComponentDataValueForKey(e){if(this.component.data)return this.component.data[e]}setComponentDataValueForKey(e,t){if(!this.component.data)throw new Error(\"The component has not been initialized.\");if(!e||e&&0===e.length)throw new Error(\"The key for the data value should be a valid string.\");this.component.data=S(S({},this.component.data),{},{[e]:t}),this.postMessage(y.SetComponentData,{componentData:this.component.data})}clearComponentData(){this.component.data={},this.postMessage(y.SetComponentData,{componentData:this.component.data})}postMessage(e,t,n){if(!this.component.sessionKey)return void this.messageQueue.push({action:e,data:t,api:f.Component,callback:n});e===y.SaveItems&&(t.height=this.params.handleRequestForContentHeight());const s={action:e,data:t,messageId:this.generateUUID(),sessionKey:this.component.sessionKey,api:f.Component},i=JSON.parse(JSON.stringify(s));let o;i.callback=n,this.sentMessages.push(i),o=this.isRunningInMobileApplication()?JSON.stringify(s):s,l.info(\"Posting message:\",o),this.contentWindow.parent.postMessage(o,this.component.origin)}activateThemes(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!this.component.acceptsThemes)return;l.info(\"Incoming themes:\",e);const{activeThemes:t}=this.component;if(t&&t.sort().toString()==e.sort().toString())return;let n=e;const s=[];for(const i of t)e.includes(i)?n=n.filter((e=>e!==i)):s.push(i);l.info(\"Deactivating themes:\",s),l.info(\"Activating themes:\",n);for(const e of s)this.deactivateTheme(e);this.component.activeThemes=e;for(const e of n){if(!e)continue;const t=this.contentWindow.document.createElement(\"link\");t.id=btoa(e),t.href=e,t.type=\"text/css\",t.rel=\"stylesheet\",t.media=\"screen,print\",t.className=\"custom-theme\",this.contentWindow.document.getElementsByTagName(\"head\")[0].appendChild(t)}this.params.onThemesChange&&this.params.onThemesChange()}themeElementForUrl(e){return Array.from(this.contentWindow.document.getElementsByClassName(\"custom-theme\")).slice().find((t=>t.id==btoa(e)))}deactivateTheme(e){const t=this.themeElementForUrl(e);t&&t.parentNode&&(t.setAttribute(\"disabled\",\"true\"),t.parentNode.removeChild(t))}generateUUID(){return h()}get platform(){return this.component.platform}get environment(){return this.component.environment}streamItems(e,t){this.postMessage(y.StreamItems,{content_types:e},(e=>{t(e.items)}))}streamContextItem(e){this.postMessage(y.StreamContextItem,{},(t=>{const{item:n}=t;(!this.lastStreamedItem||this.lastStreamedItem.uuid!==n.uuid)&&this.pendingSaveTimeout&&(clearTimeout(this.pendingSaveTimeout),this.performSavingOfItems(this.pendingSaveParams),this.pendingSaveTimeout=void 0,this.pendingSaveParams=void 0),this.lastStreamedItem=n,e(this.lastStreamedItem)}))}createItem(e,t){this.postMessage(y.CreateItem,{item:this.jsonObjectForItem(e)},(e=>{let{item:n}=e;!n&&e.items&&e.items.length>0&&(n=e.items[0]),t&&t(n)}))}createItems(e,t){const n=e.map((e=>this.jsonObjectForItem(e)));this.postMessage(y.CreateItems,{items:n},(e=>{t&&t(e.items)}))}deleteItem(e,t){this.deleteItems([e],t)}deleteItems(e,t){const n={items:e.map((e=>this.jsonObjectForItem(e)))};this.postMessage(y.DeleteItems,n,(e=>{t&&t(e)}))}sendCustomEvent(e,t,n){this.postMessage(e,t,(e=>{n&&n(e)}))}saveItem(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.saveItems([e],t,n)}saveItemWithPresave(e,t,n){this.saveItemsWithPresave([e],t,n)}saveItemsWithPresave(e,t,n){this.saveItems(e,n,!1,t)}performSavingOfItems(e){let{items:t,presave:n,callback:s}=e;const i=setTimeout((()=>{this.concernTimeouts.forEach((e=>clearTimeout(e))),alert(\"This editor is unable to communicate with Standard Notes. Your changes may not be saved. Please backup your changes, then restart the application and try again.\")}),5e3);this.concernTimeouts.push(i),n&&n();const o=[];for(const e of t)o.push(this.jsonObjectForItem(e));this.postMessage(y.SaveItems,{items:o},(()=>{this.concernTimeouts.forEach((e=>clearTimeout(e))),null==s||s()}))}saveItems(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3?arguments[3]:void 0;if(this.pendingSaveItems||(this.pendingSaveItems=[]),this.options.coallesedSaving&&!n){this.pendingSaveTimeout&&clearTimeout(this.pendingSaveTimeout);const n=e.map((e=>e.uuid)),i=this.pendingSaveItems.filter((e=>!n.includes(e.uuid)));this.pendingSaveItems=i.concat(e),this.pendingSaveParams={items:this.pendingSaveItems,presave:s,callback:t},this.pendingSaveTimeout=setTimeout((()=>{this.performSavingOfItems(this.pendingSaveParams),this.pendingSaveItems=[],this.pendingSaveTimeout=void 0,this.pendingSaveParams=null}),this.options.coallesedSavingDelay)}else this.performSavingOfItems({items:e,presave:s,callback:t})}setSize(e,t){this.postMessage(y.SetSize,{type:\"container\",width:e,height:t})}keyDownEvent(e){this.postMessage(y.KeyDown,{keyboardModifier:e})}keyUpEvent(e){this.postMessage(y.KeyUp,{keyboardModifier:e})}mouseClickEvent(){this.postMessage(y.Click,{})}jsonObjectForItem(e){const t=Object.assign({},e);return t.children=null,t.parent=null,t}getItemAppDataValue(e,t){var n,s;const i=null==e||null===(n=e.content)||void 0===n||null===(s=n.appData)||void 0===s?void 0:s[\"org.standardnotes.sn\"];return null==i?void 0:i[t]}}return t.default})()));\n//# sourceMappingURL=dist.js.map","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","import ComponentRelay from '@standardnotes/component-relay'\nimport { truncateString, htmlToText } from './Utils'\nimport type { OutgoingItemMessagePayload, NoteContent, DecryptedTransferPayload } from '@standardnotes/models'\nimport { AppDataField } from '@standardnotes/models'\nimport { EditorKitDelegate } from './EditorKitDelegate'\nimport { EditorKitOptions } from './EditorKitOptions'\n\ntype NoteMessagePayload = DecryptedTransferPayload<NoteContent> & OutgoingItemMessagePayload<NoteContent>\n\nexport default class EditorKit {\n  private componentRelay?: ComponentRelay\n  private note?: NoteMessagePayload\n  private ignoreNextTextChange?: boolean\n\n  constructor(private delegate: EditorKitDelegate, private options: EditorKitOptions) {\n    this.connectToBridge()\n  }\n\n  private connectToBridge() {\n    const { coallesedSaving, coallesedSavingDelay, mode } = this.options\n\n    this.componentRelay = new ComponentRelay({\n      targetWindow: window,\n      options: {\n        coallesedSaving,\n        /**\n         * The editor does some debouncing for us, so we'll lower the\n         * default debounce value from 250 to 150\n         */\n        coallesedSavingDelay,\n      },\n      onReady: () => {\n        const { platform } = this.componentRelay!\n\n        if (platform) {\n          document.documentElement.classList.add(platform)\n        }\n      },\n      onThemesChange: this.delegate.onThemesChange,\n      handleRequestForContentHeight: () => {\n        return this.delegate.handleRequestForContentHeight()\n      },\n    })\n\n    this.componentRelay.streamContextItem(async (note: NoteMessagePayload) => {\n      /**\n       * TODO: If note has changed, release previous temp object URLs.\n       */\n      let isNewNoteLoad = true\n      if (this.note && this.note.uuid == note.uuid) {\n        isNewNoteLoad = false\n      }\n\n      const previousNote = this.note\n\n      this.note = note\n\n      // Only update UI on non-metadata updates.\n      if (note.isMetadataUpdate) {\n        return\n      }\n\n      const text = note.content?.text || ''\n\n      /**\n       * If we're an HTML editor, and we're dealing with a new note,\n       * check to see if it's in html format.\n       * If it's not, we don't want to convert it to HTML until the user makes an explicit change\n       * so we'll ignore the next change event in this case.\n       */\n      if (mode === 'html' && isNewNoteLoad) {\n        const isHtml = /<[a-z][\\s\\S]*>/i.test(text)\n        if (!isHtml) {\n          this.ignoreNextTextChange = true\n        }\n      }\n\n      this.delegate.onNoteValueChange && (await this.delegate.onNoteValueChange(note))\n      this.delegate.setEditorRawText(text)\n\n      if (this.delegate.onNoteLockToggle) {\n        const previousLockState = this.componentRelay!.getItemAppDataValue(previousNote, 'locked') ?? false\n        const newLockState = this.componentRelay!.getItemAppDataValue(this.note, 'locked') ?? false\n\n        if (previousLockState !== newLockState) {\n          this.delegate.onNoteLockToggle(newLockState)\n        }\n      }\n\n      if (isNewNoteLoad) {\n        this.delegate.clearUndoHistory?.()\n      }\n    })\n  }\n\n  private configureFileSafe() {\n    const requiredDelegateFunctions = [\n      'getCurrentLineText',\n      'getPreviousLineText',\n      'replaceText',\n      'getElementsBySelector',\n      'insertElement',\n      'preprocessElement',\n      'insertRawText',\n    ]\n\n    for (const functionName of requiredDelegateFunctions) {\n      if (!this.delegate[functionName]) {\n        throw Error(`Missing ${functionName} delegate function.`)\n      }\n    }\n  }\n\n  /**\n   * Called by consumer when the editor has a change/input event.\n   */\n  public onEditorValueChanged(text: string): void {\n    const { mode } = this.options\n\n    if (this.ignoreNextTextChange) {\n      this.ignoreNextTextChange = false\n      return\n    }\n\n    if (!this.note) {\n      return\n    }\n\n    const note = this.note\n\n    this.componentRelay!.saveItemWithPresave<NoteContent>(note, () => {\n      note.content!.text = text\n\n      if (this.delegate.generateCustomPreview) {\n        const result = this.delegate.generateCustomPreview(text)\n\n        note.content.preview_plain = result.plain ?? ' '\n        note.content.preview_html = result.html\n      } else {\n        if (mode === 'html') {\n          let preview = text\n          preview = truncateString(htmlToText(preview))\n          /**\n           * If the preview has no length due to either being an empty note, or having just 1 FileSafe file\n           * that is stripped above, then we don't want to set to empty string, otherwise SN app will default to content\n           * for preview. We'll set a whitespace preview instead so SN doesn't go based on innate content.\n           */\n          note.content.preview_plain = preview.length > 0 ? preview : ' '\n        } else {\n          note.content.preview_plain = text\n        }\n\n        // We're only using plain in this block.\n        note.content.preview_html = undefined\n      }\n    })\n  }\n\n  /**\n   * saveItemWithPresave from the component relay.\n   */\n  public saveItemWithPresave(note: NoteMessagePayload, presave?: () => void): void {\n    this.componentRelay!.saveItemWithPresave(note, presave)\n  }\n\n  /**\n   * Gets the current platform where the component is running.\n   */\n  public get platform(): string | undefined {\n    return this.componentRelay!.platform\n  }\n\n  /**\n   * Gets the current environment where the component is running.\n   */\n  public get environment(): string | undefined {\n    return this.componentRelay!.environment\n  }\n\n  public getComponentDataValueForKey(key: string): any {\n    return this.componentRelay!.getComponentDataValueForKey(key)\n  }\n\n  public setComponentDataValueForKey(key: string, value: any): void {\n    this.componentRelay!.setComponentDataValueForKey(key, value)\n  }\n\n  public isRunningInMobileApplication(): boolean {\n    return this.componentRelay!.isRunningInMobileApplication()\n  }\n\n  public getItemAppDataValue(key: AppDataField): any {\n    return this.note && this.componentRelay!.getItemAppDataValue(this.note, key)\n  }\n}\n","export const htmlToText = (html: string): string => {\n  const tmpDocument = document.implementation.createHTMLDocument().body\n  tmpDocument.innerHTML = html\n  return tmpDocument.textContent || tmpDocument.innerText || ''\n}\n\nexport const truncateString = (text: string, limit = 90): string => {\n  if (text.length <= limit) {\n    return text\n  }\n  return text.substring(0, limit) + '...'\n}\n\nexport const sleep = async (seconds: number): Promise<void> => {\n  await new Promise((resolve) => setTimeout(resolve, seconds * 1000))\n}\n"],"names":["root","factory","exports","module","define","amd","self","t","e","d","n","s","o","Object","defineProperty","enumerable","get","prototype","hasOwnProperty","call","default","w","Web","Desktop","Mobile","i","Uint8Array","crypto","getRandomValues","bind","msCrypto","Error","a","r","test","m","c","push","toString","substr","p","l","isSupported","window","console","info","this","enabled","log","error","u","v","g","f","y","b","keys","getOwnPropertySymbols","filter","getOwnPropertyDescriptor","apply","S","arguments","length","forEach","k","getOwnPropertyDescriptors","defineProperties","value","configurable","writable","Shift","Ctrl","Meta","Component","SetSize","StreamItems","StreamContextItem","SaveItems","CreateItem","CreateItems","DeleteItems","SetComponentData","RequestPermissions","DuplicateItem","ComponentRegistered","ActivateThemes","Reply","ThemesActivated","KeyDown","KeyUp","Click","constructor","activeThemes","acceptsThemes","targetWindow","params","options","coallesedSaving","coallesedSavingDelay","component","debug","contentWindow","registerMessageHandler","registerKeyboardEventListeners","registerMouseEventListeners","deinit","onReady","messageQueue","sentMessages","lastStreamedItem","pendingSaveItems","pendingSaveTimeout","pendingSaveParams","messageHandler","document","removeEventListener","keyDownEventListener","keyUpEventListener","clickEventListener","data","referrer","URL","origin","JSON","parse","action","handleMessage","addEventListener","concat","key","ctrlKey","keyDownEvent","shiftKey","metaKey","keyUpEvent","mouseClickEvent","sessionKey","componentData","activateThemes","themes","original","messageId","title","replace","callback","environment","platform","uuid","postMessage","activeThemeUrls","getSelfComponentUUID","isRunningInDesktopApplication","isRunningInMobileApplication","getComponentDataValueForKey","setComponentDataValueForKey","clearComponentData","api","height","handleRequestForContentHeight","generateUUID","stringify","parent","sort","includes","deactivateTheme","createElement","id","btoa","href","type","rel","media","className","getElementsByTagName","appendChild","onThemesChange","themeElementForUrl","Array","from","getElementsByClassName","slice","find","parentNode","setAttribute","removeChild","random","rng","toLowerCase","TypeError","h","streamItems","content_types","items","streamContextItem","item","clearTimeout","performSavingOfItems","createItem","jsonObjectForItem","createItems","map","deleteItem","deleteItems","sendCustomEvent","saveItem","saveItems","saveItemWithPresave","saveItemsWithPresave","presave","setTimeout","concernTimeouts","alert","setSize","width","keyboardModifier","assign","children","getItemAppDataValue","content","appData","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","getter","__esModule","definition","obj","prop","EditorKit","delegate","connectToBridge","mode","componentRelay","ComponentRelay","documentElement","classList","add","async","isNewNoteLoad","note","previousNote","isMetadataUpdate","text","ignoreNextTextChange","onNoteValueChange","setEditorRawText","onNoteLockToggle","previousLockState","newLockState","clearUndoHistory","configureFileSafe","requiredDelegateFunctions","functionName","onEditorValueChanged","generateCustomPreview","result","preview_plain","plain","preview_html","html","preview","limit","substring","truncateString","tmpDocument","implementation","createHTMLDocument","body","innerHTML","textContent","innerText","htmlToText"],"sourceRoot":""}