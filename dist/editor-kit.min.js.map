{"version":3,"file":"editor-kit.min.js","mappings":"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","sources":["webpack://EditorKit/webpack/universalModuleDefinition","webpack://EditorKit/./node_modules/.pnpm/github.com+standardnotes+component-relay@839ff5db9bc92db9d42cad8d202ddc4df729597d/node_modules/@standardnotes/component-relay/dist/dist.js","webpack://EditorKit/webpack/bootstrap","webpack://EditorKit/webpack/runtime/compat get default export","webpack://EditorKit/webpack/runtime/define property getters","webpack://EditorKit/webpack/runtime/hasOwnProperty shorthand","webpack://EditorKit/./src/EditorKit.ts","webpack://EditorKit/./src/Utils.ts"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"EditorKit\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"EditorKit\"] = factory();\n\telse\n\t\troot[\"EditorKit\"] = factory();\n})(self, () => {\nreturn ","!function(e,t){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define(\"ComponentRelay\",[],t):\"object\"==typeof exports?exports.ComponentRelay=t():e.ComponentRelay=t()}(self,(()=>(()=>{\"use strict\";var e={d:(t,n)=>{for(var s in n)e.o(n,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:n[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};let n;var s;e.d(t,{default:()=>w}),function(e){e[e.Web=1]=\"Web\",e[e.Desktop=2]=\"Desktop\",e[e.Mobile=3]=\"Mobile\"}(n||(n={}));var i=new Uint8Array(16);function o(){if(!s&&!(s=\"undefined\"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||\"undefined\"!=typeof msCrypto&&\"function\"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error(\"crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported\");return s(i)}const a=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,r=function(e){return\"string\"==typeof e&&a.test(e)};for(var m=[],c=0;c<256;++c)m.push((c+256).toString(16).substr(1));const h=function(e,t,n){var s=(e=e||{}).random||(e.rng||o)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t){n=n||0;for(var i=0;i<16;++i)t[n+i]=s[i];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(m[e[t+0]]+m[e[t+1]]+m[e[t+2]]+m[e[t+3]]+\"-\"+m[e[t+4]]+m[e[t+5]]+\"-\"+m[e[t+6]]+m[e[t+7]]+\"-\"+m[e[t+8]]+m[e[t+9]]+\"-\"+m[e[t+10]]+m[e[t+11]]+m[e[t+12]]+m[e[t+13]]+m[e[t+14]]+m[e[t+15]]).toLowerCase();if(!r(n))throw TypeError(\"Stringified UUID is invalid\");return n}(s)},d=e=>{var t;const s={[n.Web]:\"web\",[n.Desktop]:\"desktop\",[n.Mobile]:\"mobile\"};return null!==(t=s[e])&&void 0!==t?t:s[n.Web]},p=()=>{};class l{static get isSupported(){return!(!window.console&&!console)}static get info(){return l.isSupported&&this.enabled?console.log.bind(console):p}static get error(){return l.isSupported?console.error.bind(console):p}}var u,v;let g,f,y;function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){k(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function k(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(v=\"enabled\")in(u=l)?Object.defineProperty(u,v,{value:false,enumerable:!0,configurable:!0,writable:!0}):u[v]=false,function(e){e.Shift=\"Shift\",e.Ctrl=\"Control\",e.Meta=\"Meta\"}(g||(g={})),function(e){e.Component=\"component\"}(f||(f={})),function(e){e.SetSize=\"set-size\",e.StreamItems=\"stream-items\",e.StreamContextItem=\"stream-context-item\",e.SaveItems=\"save-items\",e.CreateItem=\"create-item\",e.CreateItems=\"create-items\",e.DeleteItems=\"delete-items\",e.SetComponentData=\"set-component-data\",e.RequestPermissions=\"request-permissions\",e.DuplicateItem=\"duplicate-item\",e.ComponentRegistered=\"component-registered\",e.ActivateThemes=\"themes\",e.Reply=\"reply\",e.ThemesActivated=\"themes-activated\",e.KeyDown=\"key-down\",e.KeyUp=\"key-up\",e.Click=\"click\"}(y||(y={}));class w{constructor(e){var t,n;if(k(this,\"contentWindow\",void 0),k(this,\"component\",{activeThemes:[],acceptsThemes:!0}),k(this,\"sentMessages\",[]),k(this,\"messageQueue\",[]),k(this,\"lastStreamedItem\",void 0),k(this,\"pendingSaveItems\",void 0),k(this,\"pendingSaveTimeout\",void 0),k(this,\"pendingSaveParams\",void 0),k(this,\"messageHandler\",void 0),k(this,\"keyDownEventListener\",void 0),k(this,\"keyUpEventListener\",void 0),k(this,\"clickEventListener\",void 0),k(this,\"concernTimeouts\",[]),k(this,\"options\",void 0),k(this,\"params\",void 0),!e||!e.targetWindow)throw new Error(\"contentWindow must be a valid Window object.\");this.params=e,this.options=e.options||{},null==this.options.coallesedSaving&&(this.options.coallesedSaving=!0),null==this.options.coallesedSavingDelay&&(this.options.coallesedSavingDelay=250),null!=this.options.acceptsThemes&&(this.component.acceptsThemes=null===(n=this.options.acceptsThemes)||void 0===n||n),l.enabled=null!==(t=this.options.debug)&&void 0!==t&&t,this.contentWindow=e.targetWindow,this.registerMessageHandler(),this.registerKeyboardEventListeners(),this.registerMouseEventListeners()}deinit(){this.params.onReady=void 0,this.component={acceptsThemes:!0,activeThemes:[]},this.messageQueue=[],this.sentMessages=[],this.lastStreamedItem=void 0,this.pendingSaveItems=void 0,this.pendingSaveTimeout=void 0,this.pendingSaveParams=void 0,this.messageHandler&&(this.contentWindow.document.removeEventListener(\"message\",this.messageHandler),this.contentWindow.removeEventListener(\"message\",this.messageHandler)),this.keyDownEventListener&&this.contentWindow.removeEventListener(\"keydown\",this.keyDownEventListener),this.keyUpEventListener&&this.contentWindow.removeEventListener(\"keyup\",this.keyUpEventListener),this.clickEventListener&&this.contentWindow.removeEventListener(\"click\",this.clickEventListener)}registerMessageHandler(){this.messageHandler=e=>{if(l.info(\"Components API Message received:\",e.data),document.referrer&&new URL(document.referrer).origin!==new URL(e.origin).origin)return;const{data:t}=e,n=(e=>{if(\"string\"!=typeof e)return!1;try{const t=JSON.parse(e),n=Object.prototype.toString.call(t);return\"[object Object]\"===n||\"[object Array]\"===n}catch(e){return!1}})(t)?JSON.parse(t):t;if(n){if(void 0===this.component.origin&&n.action===y.ComponentRegistered)this.component.origin=e.origin;else if(e.origin!==this.component.origin)return;this.handleMessage(n)}else l.error(\"Invalid data received. Skipping...\")},this.contentWindow.document.addEventListener(\"message\",this.messageHandler,!1),this.contentWindow.addEventListener(\"message\",this.messageHandler,!1),l.info(\"Waiting for messages...\")}registerKeyboardEventListeners(){this.keyDownEventListener=e=>{l.info(\"A key has been pressed: \".concat(e.key)),e.ctrlKey?this.keyDownEvent(g.Ctrl):e.shiftKey?this.keyDownEvent(g.Shift):(e.metaKey||\"Meta\"===e.key)&&this.keyDownEvent(g.Meta)},this.keyUpEventListener=e=>{l.info(\"A key has been released: \".concat(e.key)),\"Control\"===e.key?this.keyUpEvent(g.Ctrl):\"Shift\"===e.key?this.keyUpEvent(g.Shift):\"Meta\"===e.key&&this.keyUpEvent(g.Meta)},this.contentWindow.addEventListener(\"keydown\",this.keyDownEventListener,!1),this.contentWindow.addEventListener(\"keyup\",this.keyUpEventListener,!1)}registerMouseEventListeners(){this.clickEventListener=e=>{l.info(\"A click has been performed.\"),this.mouseClickEvent()},this.contentWindow.addEventListener(\"click\",this.clickEventListener,!1)}handleMessage(e){switch(e.action){case y.ComponentRegistered:this.component.sessionKey=e.sessionKey,e.componentData&&(this.component.data=e.componentData),this.onReady(e.data),l.info(\"Component successfully registered with payload:\",e);break;case y.ActivateThemes:this.activateThemes(e.data.themes);break;default:{var t,n;if(!e.original)return;const s=null===(t=this.sentMessages)||void 0===t?void 0:t.filter((t=>{var n;return t.messageId===(null===(n=e.original)||void 0===n?void 0:n.messageId)}))[0];if(!s){const e=this.contentWindow.document.title,t=(\"The extension '\".concat(e,\"' is attempting to communicate with Standard Notes, \")+\"but an error is preventing it from doing so. Please restart this extension and try again.\").replace(\"  \",\" \");return void l.info(t)}null==s||null===(n=s.callback)||void 0===n||n.call(s,e.data);break}}}onReady(e){this.component.environment=e.environment,this.component.platform=e.platform,this.component.uuid=e.uuid;for(const e of this.messageQueue)this.postMessage(e.action,e.data,e.callback);this.messageQueue=[],l.info(\"Data passed to onReady:\",e),this.activateThemes(e.activeThemeUrls||[]),this.postMessage(y.ThemesActivated,{}),this.params.onReady&&this.params.onReady()}getSelfComponentUUID(){return this.component.uuid}isRunningInDesktopApplication(){return this.component.environment===d(n.Desktop)}isRunningInMobileApplication(){return this.component.environment===d(n.Mobile)}getComponentDataValueForKey(e){if(this.component.data)return this.component.data[e]}setComponentDataValueForKey(e,t){if(!this.component.data)throw new Error(\"The component has not been initialized.\");if(!e||e&&0===e.length)throw new Error(\"The key for the data value should be a valid string.\");this.component.data=S(S({},this.component.data),{},{[e]:t}),this.postMessage(y.SetComponentData,{componentData:this.component.data})}clearComponentData(){this.component.data={},this.postMessage(y.SetComponentData,{componentData:this.component.data})}postMessage(e,t,n){if(!this.component.sessionKey)return void this.messageQueue.push({action:e,data:t,api:f.Component,callback:n});e===y.SaveItems&&(t.height=this.params.handleRequestForContentHeight());const s={action:e,data:t,messageId:this.generateUUID(),sessionKey:this.component.sessionKey,api:f.Component},i=JSON.parse(JSON.stringify(s));let o;i.callback=n,this.sentMessages.push(i),o=this.isRunningInMobileApplication()?JSON.stringify(s):s,l.info(\"Posting message:\",o),this.contentWindow.parent.postMessage(o,this.component.origin)}activateThemes(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!this.component.acceptsThemes)return;l.info(\"Incoming themes:\",e);const{activeThemes:t}=this.component;if(t&&t.sort().toString()==e.sort().toString())return;let n=e;const s=[];for(const i of t)e.includes(i)?n=n.filter((e=>e!==i)):s.push(i);l.info(\"Deactivating themes:\",s),l.info(\"Activating themes:\",n);for(const e of s)this.deactivateTheme(e);this.component.activeThemes=e;for(const e of n){if(!e)continue;const t=this.contentWindow.document.createElement(\"link\");t.id=btoa(e),t.href=e,t.type=\"text/css\",t.rel=\"stylesheet\",t.media=\"screen,print\",t.className=\"custom-theme\",this.contentWindow.document.getElementsByTagName(\"head\")[0].appendChild(t)}this.params.onThemesChange&&this.params.onThemesChange()}themeElementForUrl(e){return Array.from(this.contentWindow.document.getElementsByClassName(\"custom-theme\")).slice().find((t=>t.id==btoa(e)))}deactivateTheme(e){const t=this.themeElementForUrl(e);t&&t.parentNode&&(t.setAttribute(\"disabled\",\"true\"),t.parentNode.removeChild(t))}generateUUID(){return h()}get platform(){return this.component.platform}get environment(){return this.component.environment}streamItems(e,t){this.postMessage(y.StreamItems,{content_types:e},(e=>{t(e.items)}))}streamContextItem(e){this.postMessage(y.StreamContextItem,{},(t=>{const{item:n}=t;(!this.lastStreamedItem||this.lastStreamedItem.uuid!==n.uuid)&&this.pendingSaveTimeout&&(clearTimeout(this.pendingSaveTimeout),this.performSavingOfItems(this.pendingSaveParams),this.pendingSaveTimeout=void 0,this.pendingSaveParams=void 0),this.lastStreamedItem=n,e(this.lastStreamedItem)}))}createItem(e,t){this.postMessage(y.CreateItem,{item:this.jsonObjectForItem(e)},(e=>{let{item:n}=e;!n&&e.items&&e.items.length>0&&(n=e.items[0]),t&&t(n)}))}createItems(e,t){const n=e.map((e=>this.jsonObjectForItem(e)));this.postMessage(y.CreateItems,{items:n},(e=>{t&&t(e.items)}))}deleteItem(e,t){this.deleteItems([e],t)}deleteItems(e,t){const n={items:e.map((e=>this.jsonObjectForItem(e)))};this.postMessage(y.DeleteItems,n,(e=>{t&&t(e)}))}sendCustomEvent(e,t,n){this.postMessage(e,t,(e=>{n&&n(e)}))}saveItem(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.saveItems([e],t,n)}saveItemWithPresave(e,t,n){this.saveItemsWithPresave([e],t,n)}saveItemsWithPresave(e,t,n){this.saveItems(e,n,!1,t)}performSavingOfItems(e){let{items:t,presave:n,callback:s}=e;const i=setTimeout((()=>{this.concernTimeouts.forEach((e=>clearTimeout(e))),alert(\"This editor is unable to communicate with Standard Notes. Your changes may not be saved. Please backup your changes, then restart the application and try again.\")}),5e3);this.concernTimeouts.push(i),n&&n();const o=[];for(const e of t)o.push(this.jsonObjectForItem(e));this.postMessage(y.SaveItems,{items:o},(()=>{this.concernTimeouts.forEach((e=>clearTimeout(e))),null==s||s()}))}saveItems(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3?arguments[3]:void 0;if(this.pendingSaveItems||(this.pendingSaveItems=[]),this.options.coallesedSaving&&!n){this.pendingSaveTimeout&&clearTimeout(this.pendingSaveTimeout);const n=e.map((e=>e.uuid)),i=this.pendingSaveItems.filter((e=>!n.includes(e.uuid)));this.pendingSaveItems=i.concat(e),this.pendingSaveParams={items:this.pendingSaveItems,presave:s,callback:t},this.pendingSaveTimeout=setTimeout((()=>{this.performSavingOfItems(this.pendingSaveParams),this.pendingSaveItems=[],this.pendingSaveTimeout=void 0,this.pendingSaveParams=null}),this.options.coallesedSavingDelay)}else this.performSavingOfItems({items:e,presave:s,callback:t})}setSize(e,t){this.postMessage(y.SetSize,{type:\"container\",width:e,height:t})}keyDownEvent(e){this.postMessage(y.KeyDown,{keyboardModifier:e})}keyUpEvent(e){this.postMessage(y.KeyUp,{keyboardModifier:e})}mouseClickEvent(){this.postMessage(y.Click,{})}jsonObjectForItem(e){const t=Object.assign({},e);return t.children=null,t.parent=null,t}getItemAppDataValue(e,t){var n,s;const i=null==e||null===(n=e.content)||void 0===n||null===(s=n.appData)||void 0===s?void 0:s[\"org.standardnotes.sn\"];return null==i?void 0:i[t]}}return t.default})()));\n//# sourceMappingURL=dist.js.map","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","import ComponentRelay from '@standardnotes/component-relay'\r\nimport { htmlToText, truncateString } from './Utils'\r\nimport type { DecryptedTransferPayload, NoteContent, OutgoingItemMessagePayload } from '@standardnotes/models'\r\nimport { AppDataField } from '@standardnotes/models'\r\nimport { EditorKitDelegate } from './EditorKitDelegate'\r\nimport { EditorKitOptions } from './EditorKitOptions'\r\n\r\ntype NoteMessagePayload = DecryptedTransferPayload<NoteContent> & OutgoingItemMessagePayload<NoteContent>\r\n\r\nexport default class EditorKit {\r\n  private componentRelay?: ComponentRelay\r\n  private note?: NoteMessagePayload\r\n  private ignoreNextTextChange?: boolean\r\n\r\n  constructor(private delegate: EditorKitDelegate, private options: EditorKitOptions) {\r\n    this.connectToBridge()\r\n  }\r\n\r\n  private connectToBridge() {\r\n    const { coallesedSaving, coallesedSavingDelay, mode } = this.options\r\n\r\n    this.componentRelay = new ComponentRelay({\r\n      targetWindow: window,\r\n      options: {\r\n        coallesedSaving,\r\n        /**\r\n         * The editor does some debouncing for us, so we'll lower the\r\n         * default debounce value from 250 to 150\r\n         */\r\n        coallesedSavingDelay,\r\n      },\r\n      onReady: () => {\r\n        const { platform } = this.componentRelay!\r\n\r\n        if (platform) {\r\n          document.documentElement.classList.add(platform)\r\n        }\r\n      },\r\n      onThemesChange: this.delegate.onThemesChange,\r\n      handleRequestForContentHeight: () => {\r\n        return this.delegate.handleRequestForContentHeight()\r\n      },\r\n    })\r\n\r\n    this.componentRelay.streamContextItem(async (note: NoteMessagePayload) => {\r\n      /**\r\n       * TODO: If note has changed, release previous temp object URLs.\r\n       */\r\n      let isNewNoteLoad = true\r\n      if (this.note && this.note.uuid == note.uuid) {\r\n        isNewNoteLoad = false\r\n      }\r\n\r\n      const previousNote = this.note\r\n\r\n      this.note = note\r\n\r\n      // Only update UI on non-metadata updates.\r\n      if (note.isMetadataUpdate) {\r\n        return\r\n      }\r\n\r\n      const text = note.content?.text || ''\r\n\r\n      /**\r\n       * If we're an HTML editor, and we're dealing with a new note,\r\n       * check to see if it's in html format.\r\n       * If it's not, we don't want to convert it to HTML until the user makes an explicit change\r\n       * so we'll ignore the next change event in this case.\r\n       */\r\n      if (mode === 'html' && isNewNoteLoad) {\r\n        const isHtml = /<[a-z][\\s\\S]*>/i.test(text)\r\n        if (!isHtml) {\r\n          this.ignoreNextTextChange = true\r\n        }\r\n      }\r\n\r\n      this.delegate.onNoteValueChange && (await this.delegate.onNoteValueChange(note))\r\n      this.delegate.setEditorRawText(text)\r\n\r\n      if (this.delegate.onNoteLockToggle) {\r\n        const previousLockState = this.componentRelay!.getItemAppDataValue(previousNote, 'locked') ?? false\r\n        const newLockState = this.componentRelay!.getItemAppDataValue(this.note, 'locked') ?? false\r\n\r\n        if (previousLockState !== newLockState) {\r\n          this.delegate.onNoteLockToggle(newLockState)\r\n        }\r\n      }\r\n\r\n      if (isNewNoteLoad) {\r\n        this.delegate.clearUndoHistory?.()\r\n      }\r\n    })\r\n  }\r\n\r\n  private configureFileSafe() {\r\n    const requiredDelegateFunctions = [\r\n      'getCurrentLineText',\r\n      'getPreviousLineText',\r\n      'replaceText',\r\n      'getElementsBySelector',\r\n      'insertElement',\r\n      'preprocessElement',\r\n      'insertRawText',\r\n    ]\r\n\r\n    for (const functionName of requiredDelegateFunctions) {\r\n      if (!this.delegate[functionName]) {\r\n        throw Error(`Missing ${functionName} delegate function.`)\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Called by consumer when the editor has a change/input event.\r\n   */\r\n  public onEditorValueChanged(text: string): void {\r\n    const { mode } = this.options\r\n\r\n    if (this.ignoreNextTextChange) {\r\n      this.ignoreNextTextChange = false\r\n      return\r\n    }\r\n\r\n    if (!this.note) {\r\n      return\r\n    }\r\n\r\n    const note = this.note\r\n\r\n    this.componentRelay!.saveItemWithPresave<NoteContent>(note, () => {\r\n      note.content!.text = text\r\n\r\n      if (this.delegate.generateCustomPreview) {\r\n        const result = this.delegate.generateCustomPreview(text)\r\n\r\n        note.content.preview_plain = result.plain ?? ' '\r\n        note.content.preview_html = result.html\r\n      } else {\r\n        if (mode === 'html') {\r\n          let preview = text\r\n          preview = truncateString(htmlToText(preview))\r\n          /**\r\n           * If the preview has no length due to either being an empty note, or having just 1 FileSafe file\r\n           * that is stripped above, then we don't want to set to empty string, otherwise SN app will default to content\r\n           * for preview. We'll set a whitespace preview instead so SN doesn't go based on innate content.\r\n           */\r\n          note.content.preview_plain = preview.length > 0 ? preview : ' '\r\n        } else {\r\n          note.content.preview_plain = text\r\n        }\r\n\r\n        // We're only using plain in this block.\r\n        note.content.preview_html = undefined\r\n      }\r\n    })\r\n  }\r\n\r\n  /**\r\n   * saveItemWithPresave from the component relay.\r\n   */\r\n  public saveItemWithPresave(note: NoteMessagePayload, presave?: () => void): void {\r\n    this.componentRelay!.saveItemWithPresave(note, presave)\r\n  }\r\n\r\n  /**\r\n   * Gets the current platform where the component is running.\r\n   */\r\n  public get platform(): string | undefined {\r\n    return this.componentRelay!.platform\r\n  }\r\n\r\n  /**\r\n   * Gets the current environment where the component is running.\r\n   */\r\n  public get environment(): string | undefined {\r\n    return this.componentRelay!.environment\r\n  }\r\n\r\n  public getComponentDataValueForKey(key: string): any {\r\n    return this.componentRelay!.getComponentDataValueForKey(key)\r\n  }\r\n\r\n  public setComponentDataValueForKey(key: string, value: any): void {\r\n    this.componentRelay!.setComponentDataValueForKey(key, value)\r\n  }\r\n\r\n  public isRunningInMobileApplication(): boolean {\r\n    return this.componentRelay!.isRunningInMobileApplication()\r\n  }\r\n\r\n  public getItemAppDataValue(key: AppDataField): any {\r\n    return this.note && this.componentRelay!.getItemAppDataValue(this.note, key)\r\n  }\r\n}\r\n","export const htmlToText = (html: string): string => {\r\n  const tmpDocument = document.implementation.createHTMLDocument().body\r\n  tmpDocument.innerHTML = html\r\n  return tmpDocument.textContent || tmpDocument.innerText || ''\r\n}\r\n\r\nexport const truncateString = (text: string, limit = 90): string => {\r\n  if (text.length <= limit) {\r\n    return text\r\n  }\r\n  return text.substring(0, limit) + '...'\r\n}\r\n\r\nexport const sleep = async (seconds: number): Promise<void> => {\r\n  await new Promise((resolve) => setTimeout(resolve, seconds * 1000))\r\n}\r\n"],"names":["root","factory","exports","module","define","amd","self","t","e","d","n","s","o","Object","defineProperty","enumerable","get","prototype","hasOwnProperty","call","default","w","Web","Desktop","Mobile","i","Uint8Array","crypto","getRandomValues","bind","msCrypto","Error","a","m","c","push","toString","substr","h","random","rng","arguments","length","toLowerCase","test","r","TypeError","p","l","isSupported","window","console","info","this","enabled","log","error","u","v","g","f","y","b","keys","getOwnPropertySymbols","filter","getOwnPropertyDescriptor","apply","S","forEach","k","getOwnPropertyDescriptors","defineProperties","value","configurable","writable","Shift","Ctrl","Meta","Component","SetSize","StreamItems","StreamContextItem","SaveItems","CreateItem","CreateItems","DeleteItems","SetComponentData","RequestPermissions","DuplicateItem","ComponentRegistered","ActivateThemes","Reply","ThemesActivated","KeyDown","KeyUp","Click","constructor","activeThemes","acceptsThemes","targetWindow","params","options","coallesedSaving","coallesedSavingDelay","component","debug","contentWindow","registerMessageHandler","registerKeyboardEventListeners","registerMouseEventListeners","deinit","onReady","messageQueue","sentMessages","lastStreamedItem","pendingSaveItems","pendingSaveTimeout","pendingSaveParams","messageHandler","document","removeEventListener","keyDownEventListener","keyUpEventListener","clickEventListener","data","referrer","URL","origin","JSON","parse","action","handleMessage","addEventListener","concat","key","ctrlKey","keyDownEvent","shiftKey","metaKey","keyUpEvent","mouseClickEvent","sessionKey","componentData","activateThemes","themes","original","messageId","title","replace","callback","environment","platform","uuid","postMessage","activeThemeUrls","getSelfComponentUUID","isRunningInDesktopApplication","isRunningInMobileApplication","getComponentDataValueForKey","setComponentDataValueForKey","clearComponentData","api","height","handleRequestForContentHeight","generateUUID","stringify","parent","sort","includes","deactivateTheme","createElement","id","btoa","href","type","rel","media","className","getElementsByTagName","appendChild","onThemesChange","themeElementForUrl","Array","from","getElementsByClassName","slice","find","parentNode","setAttribute","removeChild","streamItems","content_types","items","streamContextItem","item","clearTimeout","performSavingOfItems","createItem","jsonObjectForItem","createItems","map","deleteItem","deleteItems","sendCustomEvent","saveItem","saveItems","saveItemWithPresave","saveItemsWithPresave","presave","setTimeout","concernTimeouts","alert","setSize","width","keyboardModifier","assign","children","getItemAppDataValue","content","appData","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","getter","__esModule","definition","obj","prop","EditorKit","delegate","_defineProperty","connectToBridge","mode","componentRelay","ComponentRelay","documentElement","classList","add","async","_note$content","isNewNoteLoad","note","previousNote","isMetadataUpdate","text","ignoreNextTextChange","onNoteValueChange","setEditorRawText","onNoteLockToggle","_getItemAppDataValue","_getItemAppDataValue2","previousLockState","newLockState","_this$delegate$clearU","_this$delegate","clearUndoHistory","configureFileSafe","requiredDelegateFunctions","functionName","onEditorValueChanged","generateCustomPreview","_result$plain","result","preview_plain","plain","preview_html","html","preview","limit","substring","truncateString","tmpDocument","implementation","createHTMLDocument","body","innerHTML","textContent","innerText","htmlToText"],"sourceRoot":""}